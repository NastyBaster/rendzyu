<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>–†–µ–Ω–¥–∑—é –æ–Ω–ª–∞–π–Ω</title>
  <style>
    body { display:flex; justify-content:center; align-items:center; height:100vh; background:#f0f0f0; margin:0; }
    canvas { background:#f9d58a; box-shadow:0 0 10px rgba(0,0,0,0.5); cursor:pointer; }
  </style>
</head>
<body>
  <canvas id="board" width="600" height="600"></canvas>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>

  <script>
    // üîπ –≤—Å—Ç–∞–≤ —Ç—É—Ç —Å–≤–æ—ó –¥–∞–Ω—ñ –∑ Firebase Console
    const firebaseConfig = {
  	apiKey: "AIzaSyBXnor_Y2N9HFNqHI7hs8HBF2MRxJFTIq4",
  	authDomain: "rendzyu-ed6bf.firebaseapp.com",
  	databaseURL: "https://rendzyu-ed6bf-default-rtdb.firebaseio.com",
  	projectId: "rendzyu-ed6bf",
  	storageBucket: "rendzyu-ed6bf.firebasestorage.app",
  	messagingSenderId: "928258814163",
  	appId: "1:928258814163:web:48cbcdfaa01f9f030fe426",
  	measurementId: "G-SYK9RLDKQ5"
    };

    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const canvas = document.getElementById("board");
    const ctx = canvas.getContext("2d");
    const size = 15;
    const cell = canvas.width / size;
    let board = Array.from({length:size},()=>Array(size).fill(null));
    let current = "black"; // —á–æ—Ä–Ω–æ-–±—ñ–ª–∏–π –≥—Ä–∞–≤–µ—Ü—å

    // –º–∞–ª—é—î–º–æ –¥–æ—à–∫—É
    function drawBoard() {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      for (let i=0;i<size;i++){
        ctx.beginPath();
        ctx.moveTo(cell/2, cell/2+i*cell);
        ctx.lineTo(canvas.width-cell/2, cell/2+i*cell);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(cell/2+i*cell, cell/2);
        ctx.lineTo(cell/2+i*cell, canvas.height-cell/2);
        ctx.stroke();
      }
      for (let y=0;y<size;y++){
        for (let x=0;x<size;x++){
          if(board[y][x]){
            ctx.beginPath();
            ctx.arc(cell/2+x*cell, cell/2+y*cell, cell*0.4, 0, Math.PI*2);
            ctx.fillStyle = board[y][x];
            ctx.fill();
          }
        }
      }
    }

    // —Å–ª—É—Ö–∞—î–º–æ –±–∞–∑—É –¥–∞–Ω–∏—Ö
    db.ref("moves").on("value", snapshot => {
      const moves = snapshot.val() || {};
      board = Array.from({length:size},()=>Array(size).fill(null));
      for(let key in moves){
        const {x,y,color} = moves[key];
        board[y][x] = color;
      }
      drawBoard();
    });

    // –∫–ª—ñ–∫
    canvas.addEventListener("click", e => {
      const rect = canvas.getBoundingClientRect();
      const x = Math.floor((e.clientX - rect.left) / cell);
      const y = Math.floor((e.clientY - rect.top) / cell);
      if(!board[y][x]){
        const move = {x,y,color:current};
        db.ref("moves").push(move); // –∑–∞–ø–∏—Å—É—î–º–æ –≤ Firebase
        current = (current==="black") ? "white" : "black";
      }
    });

    drawBoard();
  </script>
</body>
</html>
